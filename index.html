<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8" />
		<title>Max Tremaine.com</title>
		<link href="icon.jpg" rel="icon" type="image/jpeg" />
		<link href="https://fonts.googleapis.com/css?family=Lato|Josefin+Slab:100" rel="stylesheet" />
		<link href="drc.css" rel="stylesheet" />
		<style>
			h1, h2 {
				padding: 18vh 2vw;
			}
			.fewer {
				display: none;
			}
		</style>
	</head>
	<body>
		<section>
			<article id="titles">
				<h1 style="font-size:7vh;">Max Tremaine<span style="font-size:3vh;color:#6BADBE;">.com</span></h1>
				<h2 style="font-size:4vh;font-family:'Josefin Slab',serif;">Co-Founder of <a href="https://www.joinsherpa.com" style="font-family:'Josefin Slab',serif;font-size:4vh;">Sherpa</a></h2>
				<hr />
			</article>
			<article id="intro">
				<p>Hello,</p>
				<p>Welcome to Max Tremaine.com, the internet's best summary resource for information about me, Max Tremaine. I spend most of my time working on <a href="http://www.joinsherpa.com" target="_blank">Sherpa</a>: the easiest way to get a travel visa. I also host <a href="http://www.traveltechto.com" target="_blank">TravelTechTO</a> on a quarterly basis. I'm interested in statistical learning, citizenship, database management systems, and disruption theory.</p>
				<p>If you're a computer, you can also read my website <a href="max_tremaine_dot_com.json" target ="_blank">in JSON</a>.</p>
				<p>-Max</p>
				<hr />
			</article>
			<article id="contact">
				<h3>How to get in touch:</h3>
				<ul style="margin: 2vh 1vh;">
					<li>I have public <a href="http://www.twitter.com/maxtremaine" target="_blank">Twitter</a> direct messages turned on, and I'll get push notifications.</li>
					<li>If you want to connect in a businessy way, I also get push notifications from <a href="https://ca.linkedin.com/in/maxtremaine" target="_blank">LinkedIn</a>.</li>
					<li>If you're super serious about business, I also have an <a href="https://angel.co/maxtremaine" target="_blank">Angel List</a> account, which I check periodically.</li>
					<li>You can email me at <a href="mailto:me@maxtremaine.com">me@maxtremaine.com</a>, but I may not see it.</li>
				</ul>
				<hr />
			</article>
		</section>
		<section id="articles_from_data" style="display:none;">
			<article id="articles">
				<h3>Articles:</h3>
				<table id="article_table"></table>
				<button id="more_articles" class="list_button" onclick="listButton('extra_articles','more_articles','fewer_articles','table-row')">More</button>
				<button id="fewer_articles" class="fewer list_button" onclick="listButton('extra_articles','fewer_articles','more_articles')">Fewer</button>
				<hr />
			</article>
			<article id="favourite_books">
				<h3>Favourite Books:</h3>
				<ol id="favourite_books_list" style="margin: 2vh 3vh;"></ol>
				<button id="more_books" class="list_button" onclick="listButton('extra_books','more_books','fewer_books','list-item')">More</button>
				<button id="fewer_books" class="fewer list_button" onclick="listButton('extra_books','fewer_books','more_books')">Fewer</button>
				<hr />
			</article>
			<article id="favourite_quotes">
				<h3>Favourite Quotes:</h3>
				<ul id="favourite_quotes_list"></ul>
				<button id="more_quotes" class="list_button" onclick="listButton('extra_quotes','more_quotes','fewer_quotes','list-item')">More</button>
				<button id="fewer_quotes" class="fewer list_button" onclick="listButton('extra_quotes','fewer_quotes','more_quotes')">Fewer</button>
				<hr />
			</article>
			<article id="resume">
				<h3>Resume:</h3>
				<table id="resume_table"></table>
				<button id="more_jobs" class="list_button" onclick="listButton('extra_jobs','more_jobs','fewer_jobs','table-row')">More</button>
				<button id="fewer_jobs" class="fewer list_button" onclick="listButton('extra_jobs','fewer_jobs','more_jobs')">Fewer</button>
				<hr />
			</article>
		</section>
		<footer style="margin-bottom:10vh;">
			<h4 style="font-size:2vh;text-align:right;">Thanks for stopping by.</h4>
		</footer>
		<script>
			/**
			 * Coordinates site construction from data.
			 */
			window.onload = () => {
				document.getElementById('articles_from_data').style.display = 'block'; // Show loaded section.
				fetch('max_tremaine_dot_com.json')
					 .then(response => response.json())
					 .then(data => {
						 data = data.max_tremaine_dot_com;
						 loadArticles(data.articles);
						 loadBooks(data.favourite_books);
						 loadQuotes(data.favourite_quotes);
						 loadResume(data.resume);
						 hideExtras();
						 logMeta(data.meta);
					 })
					 .catch(console.error);
			}
			function loadArticles(data) {
				var articlesSection = document.getElementById('article_table');
				for(var i = 0, j = 1; i < data.length; i++, j++) {
					/**
					 * This loop creates article items in the following format:
					 * <tr class=[class] style="vertical-align: top;">
					 *     <td style="padding: 2vh;">
					 *          <a href=[link] target="_blank">[title]</a>
					 *     </td>
					 *     <td style="padding: 2vh;">[description]</td>
					 * </tr>
					 */
					var articleRow = document.createElement('tr');
					var leftData = document.createElement('td');
					var articleLink = document.createElement('a');
					var articleTitle = document.createTextNode(data[i].title);
					var rightData = document.createElement('td');
					var articleDescription = document.createTextNode(data[i].description);
					var article_padding = 'padding: 2vh;';
					articlesSection.appendChild(articleRow);
					articleRow.className = (i > 1) ? 'extra_articles' : '';
					articleRow.style = (j % 2 == 0) ? 'vertical-align: top; background-color: WhiteSmoke;' : 'vertical-align: top;';
					articleRow.appendChild(leftData);
					leftData.className = 'descriptor';
					leftData.style = article_padding;
					leftData.appendChild(articleLink);
					articleLink.href = data[i].link;
					articleLink.target = '_blank';
					articleLink.appendChild(articleTitle);
					articleRow.appendChild(rightData);
					rightData.style = article_padding;
					rightData.appendChild(articleDescription);
				}
			}
			function loadBooks(data) {
				var booksList = document.getElementById('favourite_books_list');
				var sortedData = sortObject(data, 'rank');
				for(var i = 0; i < sortedData.length; i++) {
					/**
					 * This loop creates book items in the following format:
					 * <li class=[class] style="list-style-position:inside;">
					 *     <a href=[link] target="_blank">[title]</a>
					 *     [author]
					 * </li>
					 */

					var link = ['book.html?title=', sortedData[i].key].join('');
					var bookItem = document.createElement('li');
					var bookLink = document.createElement('a');
					var title = document.createTextNode(sortedData[i].title);
					var author = document.createTextNode(' by ' + sortedData[i].author);
					booksList.appendChild(bookItem);
					bookItem.className = (i > 2) ? 'extra_books' : '';
					bookItem.appendChild(bookLink);
					bookLink.href = link; 
					bookLink.appendChild(title);
					bookItem.appendChild(author);
				}
			}
			function loadQuotes(data) {
				var quotesList = document.getElementById('favourite_quotes_list');
				for(var i = 0, j = 0; i < data.length; i++) {
					/**
					 * This loop creates quote items in the following format:
					 * <li class=[class] style="list-style-type:none; margin: 2vh 1vh;">
					 *     <q>[quote]</q>
					 *     <p style="text-align:right;">[author]</p>
					 * </li>
					 */
					if(data[i].public) {
						var quoteItem = document.createElement('li');
						var quoteElement = document.createElement('q');
						var quote = document.createTextNode(data[i].quote);
						var authorElement = document.createElement('p');
						var author = document.createTextNode('- ' + data[i].author);
						quotesList.appendChild(quoteItem);
						quoteItem.className = (j > 1) ? 'extra_quotes' : '';
						quoteItem.style = 'list-style-type:none; margin: 2vh 1vh;';
						quoteItem.appendChild(quoteElement);
						quoteElement.appendChild(quote);
						quoteItem.appendChild(authorElement);
						authorElement.style = 'text-align:right;';
						authorElement.appendChild(author);
						j++
					}
				}
			}
			function loadResume(data) {
				var resumeSection = document.getElementById('resume_table');
				for(var i = 0; i < data.length; i++) {
					/**
					 * This loop creates resume items in the following format:
					 * <tr class=[class] style="vertical-align: top;">
					 *     <td class="descriptor" style="padding: 2vh;">
					 *         <a href=[link] target="_blank">[company]</a>
					 *     </td>
					 *     <td style="padding: 2vh;">[title]</td>
					 * </tr>
					 * <tr class=[class] style="vertical-align: top;">
					 *     <td class="descriptor detail" style="padding: 2vh;">[period]</td>
					 *     <td style="padding: 2vh;" class="detail">[detail]</td>
					 * </tr>
					 */

					var topRow = document.createElement('tr');
					var topLeft = document.createElement('td');
					var jobLink = document.createElement('a');
					var company = document.createTextNode(data[i].company);
					var topRight = document.createElement('td');
					var title = document.createTextNode(data[i].title);
					var bottomRow = document.createElement('tr');
					var bottomLeft = document.createElement('td');
					var period = document.createTextNode(data[i].period);
					var bottomRight = document.createElement('td');
					var description = document.createTextNode(data[i].description);
					var item_padding = 'padding: 2vh;';
					resumeSection.appendChild(topRow);
					topRow.className = (i > 0) ? 'extra_jobs' : '';
					topRow.style = 'vertical-align: top;';
					topRow.appendChild(topLeft);
					topLeft.className = 'descriptor';
					topLeft.style = item_padding;
					topLeft.appendChild(jobLink);
					jobLink.href = data[i].link;
					jobLink.target = '_blank';
					jobLink.appendChild(company);
					topRow.appendChild(topRight);
					topRight.style = item_padding;
					topRight.appendChild(title);
					resumeSection.appendChild(bottomRow);
					bottomRow.className = (i > 0) ? 'extra_jobs' : '';
					bottomRow.style = 'vertical-align : top;';
					bottomRow.appendChild(bottomLeft);
					bottomLeft.className = 'descriptor detail';
					bottomLeft.style = item_padding;
					bottomLeft.appendChild(period);
					bottomRow.appendChild(bottomRight);
					bottomRight.className = 'detail';
					bottomRight.style = item_padding;
					bottomRight.appendChild(description);
				}
			}
			function hideExtras() {
				var classes = ['.extra_books', '.extra_quotes', '.extra_articles', '.extra_jobs'];
				var extras = document.querySelectorAll(classes.join());
				for(var i = 0; i < extras.length; i++) {
					extras[i].style.display = 'none';
				}
			}
			function logMeta(data) {
				// Log the metadata for other nerds.
				console.log(['Author: ', data.author].join(''));
				console.log(['Contact: ', data.contact].join(''));
				console.log(['Last Updated: ', data.last_updated].join(''));
				console.log(data.welcome_message);
			}
			function sortObject(obj, sortKey) {
				/**
				 * Turn an object into a sorted array.
				 * Nested objects can be sorted by a key (sortKey).
				 */
				var out = Object.entries(obj);
				out = out.map(function(x) {
					let obj = x[1];
					obj['key'] = x[0];
					return obj;
				});
				if(typeof out[0][sortKey] === 'number') {
					// If the sortKey is numerical order accordingly.
					out.sort(function(a, b) {return a[sortKey] - b[sortKey]});
				} else {
					// If the sortKey is not numerical order alphabetically.
					out.sort(function(a, b) {
						let x = a[sortKey].toLowerCase();
						let y = b[sortKey].toLowerCase();
						return (x > y) ? 1 : -1;
					});
				}
				return out;
			}
			function listButton(extraClass, buttonToHide, buttonToShow, extraClassDisplayValue) {
				if(extraClassDisplayValue === undefined) {extraClassDisplayValue = 'none';}
				document.getElementById(buttonToHide).style.display = 'none';
				document.getElementById(buttonToShow).style.display = 'block';
				var extraClassElements = document.getElementsByClassName(extraClass);
				for(let x of extraClassElements) {x.style.display = extraClassDisplayValue;}
			}
			(function(i, s, o, g, r, a, m){
				// Google Tracking Code
				i['GoogleAnalyticsObject'] = r;
				i[r] = i[r] || function(){
					(i[r].q = i[r].q || []).push(arguments)
				},
				i[r].l = 1 * new Date();
				a = s.createElement(o),
				m = s.getElementsByTagName(o)[0];
				a.async = 1;
				a.src = g;
				m.parentNode.insertBefore(a, m)
			})(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
			ga('create', 'UA-45002570-1', 'auto');
			ga('send', 'pageview');
		</script>
	</body>
</html>